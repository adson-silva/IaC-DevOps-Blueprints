# ISO 27001 - Gestão de Segurança da Informação

## Visão Geral

A ISO 27001 é uma norma internacional que especifica os requisitos para estabelecer, implementar, manter e melhorar continuamente um Sistema de Gestão de Segurança da Informação (SGSI). Este documento detalha como implementar controles ISO 27001 usando Infraestrutura como Código, alinhado com o framework TOGAF.

## Mapeamento TOGAF para ISO 27001

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         TOGAF Architecture Layers                            │
├─────────────────────────────────────────────────────────────────────────────┤
│  Business Architecture    →   Política de Segurança, Gestão de Riscos      │
│  Data Architecture        →   Classificação de Dados, Proteção de Dados     │
│  Application Architecture →   Controle de Acesso, Segurança de Aplicações   │
│  Technology Architecture  →   Segurança de Rede, Criptografia, Logging      │
└─────────────────────────────────────────────────────────────────────────────┘
                                       │
                                       ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        ISO 27001 Control Domains                             │
├─────────────────────────────────────────────────────────────────────────────┤
│  A.5  Políticas de Segurança        │  A.12 Segurança Operacional          │
│  A.6  Organização                    │  A.13 Segurança de Comunicações      │
│  A.7  Segurança de RH               │  A.14 Aquisição e Desenvolvimento     │
│  A.8  Gestão de Ativos              │  A.15 Relacionamento com Fornecedores │
│  A.9  Controle de Acesso            │  A.16 Gestão de Incidentes           │
│  A.10 Criptografia                  │  A.17 Continuidade de Negócios       │
│  A.11 Segurança Física              │  A.18 Conformidade                   │
└─────────────────────────────────────────────────────────────────────────────┘
```

## Controles ISO 27001 Implementáveis via IaC

### Matriz de Controles e Implementação

| Anexo A | Controle | Implementação IaC | Ferramenta |
|---------|----------|-------------------|------------|
| A.9.1 | Política de controle de acesso | IAM policies, RBAC | Terraform |
| A.9.2 | Gestão de acesso do usuário | IAM, Identity providers | Terraform |
| A.9.4 | Controle de acesso a sistemas | Security Groups, NACLs | Terraform |
| A.10.1 | Controles criptográficos | KMS, encryption at rest | Terraform |
| A.12.4 | Registro e monitoramento | CloudWatch, Log Analytics | Terraform |
| A.13.1 | Gestão de segurança de rede | VPC, Firewall rules | Terraform |
| A.14.2 | Segurança em desenvolvimento | Pipeline security | CI/CD |
| A.17.1 | Continuidade de segurança | DR configuration, backups | Terraform |

---

## A.9 - Controle de Acesso

### A.9.1 Política de Controle de Acesso

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Identity & Access Management                          │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                         Princípios                                     │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │  │
│  │  │   Least     │  │   Need to   │  │   Role      │  │   Zero      │  │  │
│  │  │  Privilege  │  │    Know     │  │   Based     │  │   Trust     │  │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Exemplo Terraform - IAM com Least Privilege (AWS)

```hcl
#------------------------------------------------------------------------------
# A.9.1.1 - Política de Controle de Acesso
# A.9.2.3 - Gestão de direitos de acesso privilegiado
#------------------------------------------------------------------------------

# Política de acesso restritivo para aplicação
resource "aws_iam_policy" "app_policy" {
  name        = "iso27001-app-policy"
  description = "Política de acesso com least privilege - ISO 27001 A.9.1"
  
  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Sid    = "AllowS3ReadSpecificBucket"
        Effect = "Allow"
        Action = [
          "s3:GetObject",
          "s3:ListBucket"
        ]
        Resource = [
          "arn:aws:s3:::${var.app_bucket}",
          "arn:aws:s3:::${var.app_bucket}/${var.app_prefix}/*"
        ]
        Condition = {
          StringEquals = {
            "aws:SourceVpc" = var.vpc_id
          }
        }
      },
      {
        Sid    = "AllowSecretsManagerRead"
        Effect = "Allow"
        Action = [
          "secretsmanager:GetSecretValue"
        ]
        Resource = [
          "arn:aws:secretsmanager:${var.region}:${var.account_id}:secret:${var.app_name}/*"
        ]
        Condition = {
          StringEquals = {
            "secretsmanager:ResourceTag/Environment" = var.environment
          }
        }
      },
      {
        Sid    = "DenyAllOtherActions"
        Effect = "Deny"
        Action = "*"
        Resource = "*"
        Condition = {
          Bool = {
            "aws:MultiFactorAuthPresent" = "false"
          }
          StringNotEquals = {
            "aws:PrincipalType" = "Service"
          }
        }
      }
    ]
  })

  tags = {
    ISO27001Control = "A.9.1.1"
    Compliance      = "ISO27001"
  }
}

# Role com sessão limitada
resource "aws_iam_role" "app_role" {
  name                 = "iso27001-app-role"
  max_session_duration = 3600  # 1 hora máximo

  assume_role_policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Action = "sts:AssumeRole"
        Effect = "Allow"
        Principal = {
          Service = "ec2.amazonaws.com"
        }
        Condition = {
          StringEquals = {
            "aws:SourceVpc" = var.vpc_id
          }
        }
      }
    ]
  })

  tags = {
    ISO27001Control = "A.9.2.3"
    Compliance      = "ISO27001"
  }
}
```

---

## A.10 - Criptografia

### A.10.1 Controles Criptográficos

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Encryption Strategy                                │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                          At Rest                                       │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │  │
│  │  │   Storage   │  │  Database   │  │   Backups   │                    │  │
│  │  │  AES-256    │  │  TDE/KMS    │  │   KMS       │                    │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                         In Transit                                     │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │  │
│  │  │    TLS      │  │   mTLS      │  │    VPN      │                    │  │
│  │  │   1.2+      │  │  Services   │  │  IPSec      │                    │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                       Key Management                                   │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │  │
│  │  │    KMS      │  │  Rotation   │  │   HSM       │                    │  │
│  │  │  Managed    │  │  Automatic  │  │  (FIPS)     │                    │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Exemplo Terraform - Criptografia (AWS)

```hcl
#------------------------------------------------------------------------------
# A.10.1.1 - Política sobre o uso de controles criptográficos
# A.10.1.2 - Gestão de chaves
#------------------------------------------------------------------------------

# KMS Key com rotação automática
resource "aws_kms_key" "main" {
  description              = "KMS key for ISO 27001 compliance"
  deletion_window_in_days  = 30
  enable_key_rotation      = true
  multi_region             = false
  
  # Política de uso da chave
  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Sid    = "EnableRootAccountAccess"
        Effect = "Allow"
        Principal = {
          AWS = "arn:aws:iam::${var.account_id}:root"
        }
        Action   = "kms:*"
        Resource = "*"
      },
      {
        Sid    = "AllowKeyAdministrators"
        Effect = "Allow"
        Principal = {
          AWS = var.key_admin_arns
        }
        Action = [
          "kms:Create*",
          "kms:Describe*",
          "kms:Enable*",
          "kms:List*",
          "kms:Put*",
          "kms:Update*",
          "kms:Revoke*",
          "kms:Disable*",
          "kms:Get*",
          "kms:Delete*",
          "kms:TagResource",
          "kms:UntagResource",
          "kms:ScheduleKeyDeletion",
          "kms:CancelKeyDeletion"
        ]
        Resource = "*"
      },
      {
        Sid    = "AllowKeyUsage"
        Effect = "Allow"
        Principal = {
          AWS = var.key_user_arns
        }
        Action = [
          "kms:Encrypt",
          "kms:Decrypt",
          "kms:ReEncrypt*",
          "kms:GenerateDataKey*",
          "kms:DescribeKey"
        ]
        Resource = "*"
        Condition = {
          StringEquals = {
            "kms:EncryptionContext:Environment" = var.environment
          }
        }
      },
      {
        Sid    = "AllowServiceAccess"
        Effect = "Allow"
        Principal = {
          Service = [
            "s3.amazonaws.com",
            "rds.amazonaws.com",
            "secretsmanager.amazonaws.com"
          ]
        }
        Action = [
          "kms:Encrypt",
          "kms:Decrypt",
          "kms:GenerateDataKey*"
        ]
        Resource = "*"
        Condition = {
          StringEquals = {
            "aws:SourceAccount" = var.account_id
          }
        }
      }
    ]
  })

  tags = {
    ISO27001Control = "A.10.1.2"
    Compliance      = "ISO27001"
    Environment     = var.environment
  }
}

resource "aws_kms_alias" "main" {
  name          = "alias/iso27001-${var.environment}"
  target_key_id = aws_kms_key.main.key_id
}

# S3 Bucket com criptografia obrigatória
resource "aws_s3_bucket" "encrypted" {
  bucket = "${var.project}-${var.environment}-encrypted"

  tags = {
    ISO27001Control = "A.10.1.1"
    Compliance      = "ISO27001"
  }
}

resource "aws_s3_bucket_server_side_encryption_configuration" "encrypted" {
  bucket = aws_s3_bucket.encrypted.id

  rule {
    apply_server_side_encryption_by_default {
      kms_master_key_id = aws_kms_key.main.arn
      sse_algorithm     = "aws:kms"
    }
    bucket_key_enabled = true
  }
}

# Negar uploads não criptografados
resource "aws_s3_bucket_policy" "require_encryption" {
  bucket = aws_s3_bucket.encrypted.id

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Sid       = "DenyUnencryptedUploads"
        Effect    = "Deny"
        Principal = "*"
        Action    = "s3:PutObject"
        Resource  = "${aws_s3_bucket.encrypted.arn}/*"
        Condition = {
          StringNotEquals = {
            "s3:x-amz-server-side-encryption" = "aws:kms"
          }
        }
      },
      {
        Sid       = "DenyWrongKMSKey"
        Effect    = "Deny"
        Principal = "*"
        Action    = "s3:PutObject"
        Resource  = "${aws_s3_bucket.encrypted.arn}/*"
        Condition = {
          StringNotEquals = {
            "s3:x-amz-server-side-encryption-aws-kms-key-id" = aws_kms_key.main.arn
          }
        }
      },
      {
        Sid       = "DenyInsecureTransport"
        Effect    = "Deny"
        Principal = "*"
        Action    = "s3:*"
        Resource = [
          aws_s3_bucket.encrypted.arn,
          "${aws_s3_bucket.encrypted.arn}/*"
        ]
        Condition = {
          Bool = {
            "aws:SecureTransport" = "false"
          }
        }
      }
    ]
  })
}
```

---

## A.12 - Segurança Operacional

### A.12.4 Registro e Monitoramento

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Logging Architecture                                 │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                          Log Sources                                   │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  │  │
│  │  │ Application │  │   System    │  │  Security   │  │   Network   │  │  │
│  │  │    Logs     │  │    Logs     │  │    Logs     │  │    Logs     │  │  │
│  │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  │  │
│  └─────────┼────────────────┼────────────────┼────────────────┼─────────┘  │
│            └────────────────┴────────────────┴────────────────┘            │
│                                    │                                        │
│                                    ▼                                        │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                       Central Log Management                           │  │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │  │
│  │  │ Collection  │  │   Storage   │  │  Analysis   │                    │  │
│  │  │             │──│   (WORM)    │──│  & Alerts   │                    │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Exemplo Terraform - Logging (AWS)

```hcl
#------------------------------------------------------------------------------
# A.12.4.1 - Registro de eventos
# A.12.4.2 - Proteção de informações de registro
# A.12.4.3 - Registros de administrador e operador
#------------------------------------------------------------------------------

# CloudTrail para auditoria
resource "aws_cloudtrail" "main" {
  name                          = "iso27001-trail"
  s3_bucket_name                = aws_s3_bucket.logs.id
  s3_key_prefix                 = "cloudtrail"
  include_global_service_events = true
  is_multi_region_trail         = true
  enable_logging                = true
  enable_log_file_validation    = true
  kms_key_id                    = aws_kms_key.logs.arn

  event_selector {
    read_write_type           = "All"
    include_management_events = true

    data_resource {
      type   = "AWS::S3::Object"
      values = ["arn:aws:s3"]
    }

    data_resource {
      type   = "AWS::Lambda::Function"
      values = ["arn:aws:lambda"]
    }
  }

  insight_selector {
    insight_type = "ApiCallRateInsight"
  }

  insight_selector {
    insight_type = "ApiErrorRateInsight"
  }

  tags = {
    ISO27001Control = "A.12.4.1"
    Compliance      = "ISO27001"
  }
}

# Log Group com retenção e criptografia
resource "aws_cloudwatch_log_group" "app" {
  name              = "/iso27001/${var.app_name}"
  retention_in_days = 365  # Mínimo 1 ano para compliance
  kms_key_id        = aws_kms_key.logs.arn

  tags = {
    ISO27001Control = "A.12.4.2"
    Compliance      = "ISO27001"
  }
}

# Bucket de logs com Object Lock (WORM)
resource "aws_s3_bucket" "logs" {
  bucket = "${var.project}-${var.environment}-logs"
  
  object_lock_enabled = true

  tags = {
    ISO27001Control = "A.12.4.2"
    Compliance      = "ISO27001"
  }
}

resource "aws_s3_bucket_object_lock_configuration" "logs" {
  bucket = aws_s3_bucket.logs.id

  rule {
    default_retention {
      mode = "GOVERNANCE"
      days = 365
    }
  }
}

resource "aws_s3_bucket_lifecycle_configuration" "logs" {
  bucket = aws_s3_bucket.logs.id

  rule {
    id     = "archive-logs"
    status = "Enabled"

    transition {
      days          = 90
      storage_class = "GLACIER"
    }

    expiration {
      days = 2555  # 7 anos para compliance
    }
  }
}

# Alertas de segurança
resource "aws_cloudwatch_metric_alarm" "security_alerts" {
  for_each = {
    unauthorized_api_calls = {
      pattern     = "{ ($.errorCode = \"*UnauthorizedAccess*\") || ($.errorCode = \"AccessDenied*\") }"
      description = "Unauthorized API calls detected"
    }
    root_account_usage = {
      pattern     = "{ $.userIdentity.type = \"Root\" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != \"AwsServiceEvent\" }"
      description = "Root account usage detected"
    }
    console_login_without_mfa = {
      pattern     = "{ ($.eventName = \"ConsoleLogin\") && ($.additionalEventData.MFAUsed != \"Yes\") }"
      description = "Console login without MFA detected"
    }
  }

  alarm_name          = "iso27001-${each.key}"
  comparison_operator = "GreaterThanThreshold"
  evaluation_periods  = 1
  metric_name         = each.key
  namespace           = "ISO27001/SecurityEvents"
  period              = 300
  statistic           = "Sum"
  threshold           = 0
  alarm_description   = each.value.description
  alarm_actions       = [aws_sns_topic.security_alerts.arn]

  tags = {
    ISO27001Control = "A.12.4.1"
    Compliance      = "ISO27001"
  }
}
```

---

## A.13 - Segurança de Comunicações

### A.13.1 Gestão de Segurança de Rede

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Network Security Zones                               │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  DMZ (Public)                                                          │  │
│  │  ┌─────────────┐  ┌─────────────┐                                     │  │
│  │  │    WAF      │──│    ALB      │                                     │  │
│  │  └─────────────┘  └─────────────┘                                     │  │
│  └──────────────────────────┬────────────────────────────────────────────┘  │
│                             │                                               │
│  ┌──────────────────────────┼────────────────────────────────────────────┐  │
│  │  Application Zone        │                                             │  │
│  │  ┌─────────────┐  ┌──────┴──────┐  ┌─────────────┐                    │  │
│  │  │   App       │  │   App       │  │   App       │                    │  │
│  │  │  Server 1   │  │  Server 2   │  │  Server 3   │                    │  │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                    │  │
│  └──────────────────────────┬────────────────────────────────────────────┘  │
│                             │                                               │
│  ┌──────────────────────────┼────────────────────────────────────────────┐  │
│  │  Data Zone               │                                             │  │
│  │  ┌─────────────┐  ┌──────┴──────┐                                     │  │
│  │  │  Database   │  │   Cache     │                                     │  │
│  │  │  (Encrypted)│  │  (Private)  │                                     │  │
│  │  └─────────────┘  └─────────────┘                                     │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Exemplo Terraform - Segurança de Rede (AWS)

```hcl
#------------------------------------------------------------------------------
# A.13.1.1 - Controles de rede
# A.13.1.2 - Segurança de serviços de rede
# A.13.1.3 - Segregação em redes
#------------------------------------------------------------------------------

# VPC com subnets segregadas
module "vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "~> 5.0"

  name = "iso27001-vpc"
  cidr = "10.0.0.0/16"

  azs             = ["us-east-1a", "us-east-1b", "us-east-1c"]
  public_subnets  = ["10.0.1.0/24", "10.0.2.0/24", "10.0.3.0/24"]
  private_subnets = ["10.0.11.0/24", "10.0.12.0/24", "10.0.13.0/24"]
  database_subnets = ["10.0.21.0/24", "10.0.22.0/24", "10.0.23.0/24"]

  enable_nat_gateway     = true
  single_nat_gateway     = false
  one_nat_gateway_per_az = true

  enable_dns_hostnames = true
  enable_dns_support   = true

  # Flow Logs para auditoria
  enable_flow_log                      = true
  create_flow_log_cloudwatch_log_group = true
  create_flow_log_cloudwatch_iam_role  = true

  tags = {
    ISO27001Control = "A.13.1.3"
    Compliance      = "ISO27001"
  }
}

# Security Group - Tier Web (DMZ)
resource "aws_security_group" "web" {
  name        = "iso27001-web-sg"
  description = "Security group for web tier - A.13.1.1"
  vpc_id      = module.vpc.vpc_id

  ingress {
    description = "HTTPS from Internet"
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  ingress {
    description = "HTTP redirect"
    from_port   = 80
    to_port     = 80
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }

  egress {
    description     = "To app tier only"
    from_port       = 8080
    to_port         = 8080
    protocol        = "tcp"
    security_groups = [aws_security_group.app.id]
  }

  tags = {
    ISO27001Control = "A.13.1.1"
    Compliance      = "ISO27001"
    Tier            = "web"
  }
}

# Security Group - Tier Aplicação
resource "aws_security_group" "app" {
  name        = "iso27001-app-sg"
  description = "Security group for app tier - A.13.1.1"
  vpc_id      = module.vpc.vpc_id

  ingress {
    description     = "From web tier"
    from_port       = 8080
    to_port         = 8080
    protocol        = "tcp"
    security_groups = [aws_security_group.web.id]
  }

  egress {
    description     = "To database tier"
    from_port       = 5432
    to_port         = 5432
    protocol        = "tcp"
    security_groups = [aws_security_group.database.id]
  }

  egress {
    description     = "To cache"
    from_port       = 6379
    to_port         = 6379
    protocol        = "tcp"
    security_groups = [aws_security_group.cache.id]
  }

  egress {
    description = "HTTPS for AWS services"
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    prefix_list_ids = [
      aws_vpc_endpoint.s3.prefix_list_id
    ]
  }

  tags = {
    ISO27001Control = "A.13.1.1"
    Compliance      = "ISO27001"
    Tier            = "app"
  }
}

# Security Group - Tier Database
resource "aws_security_group" "database" {
  name        = "iso27001-db-sg"
  description = "Security group for database tier - A.13.1.1"
  vpc_id      = module.vpc.vpc_id

  ingress {
    description     = "PostgreSQL from app tier"
    from_port       = 5432
    to_port         = 5432
    protocol        = "tcp"
    security_groups = [aws_security_group.app.id]
  }

  # No egress rules - database should not initiate connections

  tags = {
    ISO27001Control = "A.13.1.1"
    Compliance      = "ISO27001"
    Tier            = "database"
  }
}

# NACLs adicionais para defense in depth
resource "aws_network_acl" "database" {
  vpc_id     = module.vpc.vpc_id
  subnet_ids = module.vpc.database_subnets

  ingress {
    rule_no    = 100
    action     = "allow"
    protocol   = "tcp"
    from_port  = 5432
    to_port    = 5432
    cidr_block = "10.0.11.0/24"  # App subnet 1
  }

  ingress {
    rule_no    = 101
    action     = "allow"
    protocol   = "tcp"
    from_port  = 5432
    to_port    = 5432
    cidr_block = "10.0.12.0/24"  # App subnet 2
  }

  ingress {
    rule_no    = 102
    action     = "allow"
    protocol   = "tcp"
    from_port  = 5432
    to_port    = 5432
    cidr_block = "10.0.13.0/24"  # App subnet 3
  }

  ingress {
    rule_no    = 200
    action     = "deny"
    protocol   = "-1"
    from_port  = 0
    to_port    = 0
    cidr_block = "0.0.0.0/0"
  }

  egress {
    rule_no    = 100
    action     = "allow"
    protocol   = "tcp"
    from_port  = 1024
    to_port    = 65535
    cidr_block = "10.0.0.0/8"
  }

  egress {
    rule_no    = 200
    action     = "deny"
    protocol   = "-1"
    from_port  = 0
    to_port    = 0
    cidr_block = "0.0.0.0/0"
  }

  tags = {
    ISO27001Control = "A.13.1.1"
    Compliance      = "ISO27001"
  }
}
```

---

## Checklist de Conformidade ISO 27001

### Controles Implementáveis via IaC

| Controle | Descrição | Status | Evidência |
|----------|-----------|--------|-----------|
| A.9.1.1 | Política de controle de acesso | ✅ | IAM policies |
| A.9.2.3 | Gestão de acessos privilegiados | ✅ | IAM roles, MFA |
| A.9.4.1 | Restrição de acesso à informação | ✅ | Security groups |
| A.10.1.1 | Política de uso de criptografia | ✅ | KMS, encryption |
| A.10.1.2 | Gestão de chaves | ✅ | KMS key policies |
| A.12.4.1 | Registro de eventos | ✅ | CloudTrail, logs |
| A.12.4.2 | Proteção de logs | ✅ | WORM, encryption |
| A.13.1.1 | Controles de rede | ✅ | VPC, SGs, NACLs |
| A.13.1.3 | Segregação de redes | ✅ | Subnets, tiers |
| A.17.1.1 | Planejamento de continuidade | ✅ | Multi-AZ, DR |

---

## Referências

- [ISO/IEC 27001:2022](https://www.iso.org/standard/27001)
- [TOGAF Standard](https://www.opengroup.org/togaf)
- [AWS Security Best Practices](https://aws.amazon.com/architecture/security-identity-compliance/)
- [Azure Security Documentation](https://docs.microsoft.com/azure/security/)
- [GCP Security Best Practices](https://cloud.google.com/security/best-practices)